<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TempleOS_BTC_Oracle_V1.0</title>
    <style>
        /* THE 16 DIVINE COLORS */
        :root {
            --black: #000000; --blue: #0000AA; --green: #00AA00; --cyan: #00AAAA;
            --red: #AA0000; --purple: #AA00AA; --brown: #AA5500; --ltgray: #AAAAAA;
            --dkgray: #555555; --ltblue: #5555FF; --ltgreen: #55FF55; --ltcyan: #55FFFF;
            --ltred: #FF5555; --ltpurple: #FF55FF; --yellow: #FFFF55; --white: #FFFFFF;
        }

        body { 
            margin: 0; overflow: hidden; 
            background-color: var(--white); 
            font-family: "Courier New", Courier, monospace;
            image-rendering: pixelated;
        }

        /* DIVINE INTERFACE */
        #top-bar {
            background-color: var(--blue); color: var(--white);
            padding: 4px; font-weight: bold; border-bottom: 2px solid var(--black);
            display: flex; justify-content: space-between;
        }

        #oracle-ui {
            position: absolute; top: 40px; left: 20px;
            background: var(--white); border: 4px ridge var(--ltgray);
            padding: 10px; z-index: 100;
        }

        .god-text { color: var(--blue); font-size: 24px; font-weight: bold; }
        .data-text { color: var(--red); font-size: 18px; }

        #sidebar {
            position: absolute; right: 0; top: 32px; bottom: 0;
            width: 250px; background: var(--white);
            border-left: 2px solid var(--black); padding: 10px;
            overflow-y: hidden; font-size: 12px;
        }

        .msg { color: var(--purple); margin-bottom: 5px; border-bottom: 1px dashed var(--ltgray); }
        canvas { display: block; }
    </style>
</head>
<body>

<div id="top-bar">
    <span>TempleOS V5.03 - God's Bitcoin Oracle - 64-Bit Mode</span>
    <span id="clock">00:00:00</span>
</div>

<div id="oracle-ui">
    <div class="god-text">PRICE: $<span id="price">...</span></div>
    <div class="data-text">HASHRATE: <span id="hash">...</span> EH/s</div>
    <div style="color: var(--green); font-size: 14px; margin-top: 5px;">[DIVINE_MODE_ACTIVE]</div>
</div>

<div id="sidebar">
    <div style="color: var(--blue); font-weight: bold; margin-bottom: 10px; border-bottom: 2px solid var(--blue);">DIVINE_MATCH_LOG</div>
    <div id="log"></div>
</div>

<canvas id="screen"></canvas>

<script>
    const canvas = document.getElementById('screen');
    const ctx = canvas.getContext('2d');
    
    let state = {
        price: 0,
        history: [],
        hash: 780_000_000_000_000_000_000n,
        tick: 0
    };

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    async function init() {
        // Fetch Historical Candles
        const candles = await fetch('https://api.exchange.coinbase.com/products/BTC-USD/candles?granularity=300').then(r => r.json());
        state.history = candles.map(c => c[4]).reverse();

        const ws = new WebSocket('wss://ws-feed.exchange.coinbase.com');
        ws.onopen = () => ws.send(JSON.stringify({ type: "subscribe", channels: ["ticker", "matches"], product_ids: ["BTC-USD"] }));
        ws.onmessage = (e) => {
            const data = JSON.parse(e.data);
            if (data.type === 'ticker') {
                state.price = parseFloat(data.price);
                document.getElementById('price').innerText = state.price.toLocaleString();
            }
            if (data.type === 'match') {
                const div = document.createElement('div');
                div.className = 'msg';
                div.innerText = `GOD_SAYS: ${data.size} @ ${data.price}`;
                const log = document.getElementById('log');
                log.prepend(div);
                if(log.childNodes.length > 30) log.lastChild.remove();
            }
        };

        // 64-bit Divine RNG Jitter
        setInterval(() => {
            state.hash += BigInt(Math.floor((Math.random()-0.5)*5000000000000000));
            document.getElementById('hash').innerText = (state.hash / 1_000_000_000_000_000_000n).toString();
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        }, 1000);
    }

    function drawTemple() {
        const w = window.innerWidth, h = window.innerHeight;
        state.tick++;

        // CLEAR TO WHITE
        ctx.fillStyle = "#FFFFFF";
        ctx.fillRect(0, 0, w, h);

        // DRAW DIVINE GRID (Classic TempleOS)
        ctx.strokeStyle = "#AAAAAA";
        ctx.lineWidth = 1;
        for(let i=0; i<w; i+=16) {
            ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, h); ctx.stroke();
        }
        for(let j=0; j<h; j+=16) {
            ctx.beginPath(); ctx.moveTo(0, j); ctx.lineTo(w, j); ctx.stroke();
        }

        // DRAW THE ORACLE GRAPH (The Chart)
        if (state.history.length > 0) {
            ctx.strokeStyle = "#0000AA"; // Blue Chart
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            const min = Math.min(...state.history);
            const max = Math.max(...state.history);
            const range = max - min;
            const step = (w - 250) / state.history.length;

            state.history.forEach((p, i) => {
                const x = i * step;
                const y = (h - 100) - ((p - min) / range * (h - 200));
                if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
            });
            ctx.stroke();

            // Fill under the graph with a dither pattern
            ctx.globalAlpha = 0.1;
            ctx.fillStyle = "#55FFFF";
            ctx.lineTo((state.history.length-1)*step, h);
            ctx.lineTo(0, h);
            ctx.fill();
            ctx.globalAlpha = 1.0;
        }

        // DIVINE SPRITES (God's Randomness)
        const cx = (w - 250) / 2;
        const cy = h / 2;
        
        // Dancing Elephant (Placeholder for TempleOS vibe)
        ctx.fillStyle = "#AA00AA";
        const dance = Math.sin(state.tick * 0.1) * 20;
        ctx.fillRect(cx - 50, cy + dance, 100, 60); // Body
        ctx.fillStyle = "#FFFFFF";
        ctx.fillRect(cx - 40, cy + 10 + dance, 20, 20); // Eye
        ctx.fillStyle = "#000000";
        ctx.fillRect(cx - 35, cy + 15 + dance, 10, 10); // Pupil

        // THE WORD OF GOD (Random Bytes from Hashrate)
        ctx.fillStyle = "#AA5500";
        ctx.font = "bold 14px Courier New";
        const words = ["BITCOIN", "HOLY", "64-BIT", "PROOF", "FAITH", "BLOCK"];
        for(let i=0; i<5; i++) {
            const word = words[Math.floor(Number(state.hash % BigInt(words.length)))];
            ctx.fillText(word, 300, 100 + (i*20));
        }
    }

    function frame() {
        drawTemple();
        requestAnimationFrame(frame);
    }

    init(); frame();
</script>
</body>
</html>
