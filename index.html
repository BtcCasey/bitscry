<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BITSCRY - THE DIVINE BLOCKCHAIN</title>
    <style>
        :root {
            --white: #FFFFFF; --blue: #0000AA; --red: #AA0000; --cyan: #00AAAA;
            --purple: #AA00AA; --yellow: #FFFF55; --black: #000000; --green: #00AA00;
            --orange: #FF5555;
        }
        body { 
            margin: 0; background-color: var(--black); 
            font-family: "Courier New", monospace; color: var(--white);
            overflow: hidden; image-rendering: pixelated;
        }
        #vga-frame {
            width: 100vw; height: 100vh;
            border: 8px ridge var(--cyan); box-sizing: border-box;
            display: grid; grid-template-columns: 240px 1fr 280px;
        }
        .panel { border: 2px solid var(--blue); padding: 10px; position: relative; overflow: hidden; background: var(--white); color: var(--black); }
        .header { background: var(--blue); color: var(--white); font-weight: bold; text-align: center; margin: -10px -10px 10px -10px; padding: 2px; }
        
        #price-display { color: var(--red); font-size: 32px; text-align: center; font-weight: bold; }
        #sisyphus-container { position: relative; height: 200px; border-bottom: 4px solid var(--black); margin-top: 20px; }
        #boulder { position: absolute; width: 60px; height: 60px; background: var(--dkgray); border-radius: 50%; border: 3px solid var(--black); bottom: 0; }
        #sisyphus-man { position: absolute; bottom: 0; font-size: 20px; font-weight: bold; transition: left 0.1s linear; }
        
        canvas { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none; }
        .stat-val { color: var(--blue); font-weight: bold; font-size: 18px; }
    </style>
</head>
<body>

<div id="vga-frame">
    <div class="panel">
        <div class="header">SISYPHUS.EXE</div>
        <div style="font-size: 12px;">UNCONFIRMED_TX:</div>
        <div id="mempool-count" class="stat-val">FETCHING...</div>
        
        <div id="sisyphus-container">
            <div id="boulder" style="left: 100px; background: repeating-conic-gradient(var(--ltgray) 0% 25%, var(--dkgray) 0% 50%);"></div>
            <div id="sisyphus-man" style="left: 60px;">&lt;O/</div>
        </div>
        <p style="font-size: 11px; color: var(--red); margin-top: 10px; font-weight: bold;">"HIS LABOR IS ETERNAL"</p>
    </div>

    <div class="panel" style="background: var(--white);">
        <div class="header" style="background: var(--red);">BITSCRY_DIVINE_ORACLE</div>
        <div id="price-display">℥ ...</div>
        <div style="text-align:center; color: var(--blue); font-size:12px; font-weight: bold;">HASHRATE: <span id="hash-val">0</span> EH/s</div>
        
        <canvas id="ritual-canvas"></canvas>
    </div>

    <div class="panel">
        <div class="header">PROPHET.TXT</div>
        <div id="log" style="font-size: 11px; height: 60%; overflow: hidden;"></div>
        <div style="border-top: 2px solid var(--blue); padding-top: 10px; font-size: 12px; color: var(--purple);">
            <b>SCRIPTURE_SEED:</b><br>
            <span id="verse">"In the beginning God created the heaven and the earth."</span>
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById('ritual-canvas');
    const ctx = canvas.getContext('2d');
    let state = { price: 0, hash: 790n, txCount: 0, ticks: 0, history: [] };

    function resize() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    async function syncMempool() {
        try {
            const res = await fetch('https://mempool.space/api/mempool');
            const data = await res.json();
            state.txCount = data.count;
            document.getElementById('mempool-count').innerText = state.txCount.toLocaleString();
        } catch(e) { console.log("Mempool busy."); }
    }

    async function init() {
        const candles = await fetch('https://api.exchange.coinbase.com/products/BTC-USD/candles?granularity=3600').then(r => r.json());
        state.history = candles.slice(0, 12).map(c => c[4]).reverse();

        const ws = new WebSocket('wss://ws-feed.exchange.coinbase.com');
        ws.onopen = () => ws.send(JSON.stringify({ type: "subscribe", channels: ["ticker", "matches"], product_ids: ["BTC-USD"] }));
        ws.onmessage = (e) => {
            const data = JSON.parse(e.data);
            if (data.type === 'ticker') {
                state.price = parseFloat(data.price);
                document.getElementById('price-display').innerText = `℥ ${state.price.toLocaleString()}`;
            }
        };

        setInterval(syncMempool, 5000);
        syncMempool();
    }

    function drawFlame(x, y, size) {
        const flicker = Math.sin(state.ticks * 0.2) * 5;
        ctx.fillStyle = "#FFFF55"; // Yellow core
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.quadraticCurveTo(x - 10, y + 20, x, y + 40 + flicker);
        ctx.quadraticCurveTo(x + 10, y + 20, x, y);
        ctx.fill();
        
        // Red glow dither
        ctx.fillStyle = "#AA0000";
        ctx.globalAlpha = 0.3;
        ctx.beginPath();
        ctx.arc(x, y + 20, 15, 0, Math.PI*2);
        ctx.fill();
        ctx.globalAlpha = 1.0;
    }

    function render() {
        const w = canvas.width, h = canvas.height;
        const cx = w/2, cy = h/2;
        state.ticks++;

        ctx.clearRect(0, 0, w, h);

        // 1. ZODIAC RING
        ctx.strokeStyle = "#AAAAAA";
        ctx.setLineDash([4, 4]);
        ctx.beginPath(); ctx.arc(cx, cy, 180, 0, Math.PI*2); ctx.stroke();
        ctx.setLineDash([]);

        // 2. THE MENORAH (Divine Flames)
        if(state.history.length > 0) {
            const min = Math.min(...state.history);
            const max = Math.max(...state.history);
            const range = max - min;
            
            state.history.forEach((p, i) => {
                const x = cx - 150 + (i * 30);
                const h_val = ((p - min) / range) * 100 + 50;
                const y = cy + 100 - h_val;
                
                // Draw Candle
                ctx.fillStyle = "#AA5500"; // Brown/Gold
                ctx.fillRect(x - 4, y, 8, h_val);
                
                // Draw Filled Flame
                drawFlame(x, y - 45, h_val);
            });
        }

        // 3. SISYPHUS LOGIC
        const sisyMan = document.getElementById('sisyphus-man');
        const boulder = document.getElementById('boulder');
        // Movement is based on current price "momentum" or just a steady divine struggle
        const walk = (state.ticks % 200);
        sisyMan.style.left = (walk) + "px";
        boulder.style.left = (walk + 30) + "px";
        boulder.style.transform = `rotate(${state.ticks * 5}deg)`;

        requestAnimationFrame(render);
    }

    init(); render();
</script>
</body>
</html>
