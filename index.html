<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>THE SCRYING ORB: 64-BIT PRECISION</title>
    <link href="https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@400;700&family=IM+Fell+DW+Pica:ital@0;1&display=swap" rel="stylesheet">
    <style>
        :root {
            --paper: #eeddb0;
            --gold: #ffcc33;
            --mana: #00d4ff;
            --blood: #ff4b2b;
            --stone: #3d342d;
        }
        body { margin: 0; overflow: hidden; background: #120e0a; font-family: 'IM Fell DW Pica', serif; }
        
        /* UI Layers */
        #price-tag {
            position: absolute; top: 40px; left: 60px;
            font-family: 'Grenze Gotisch', serif; font-size: 68px;
            color: var(--gold); text-shadow: 0 0 30px rgba(0,0,0,0.5); z-index: 20;
        }

        #hash-rate-display {
            position: absolute; top: 120px; left: 65px;
            font-family: 'IM Fell DW Pica'; font-size: 20px;
            color: var(--mana); letter-spacing: 1px; font-style: italic; z-index: 20;
            text-shadow: 0 0 10px rgba(0,212,255,0.3);
        }

        #spellbook {
            position: absolute; bottom: 40px; right: 60px; 
            width: 380px; height: 500px; 
            background: var(--paper); border: 12px solid #4a3728;
            padding: 30px; box-shadow: 0 0 60px rgba(0,0,0,0.9);
            transform: perspective(1200px) rotateY(-10deg) rotateX(2deg); z-index: 10;
            background-image: radial-gradient(circle at center, transparent 0%, rgba(0,0,0,0.05) 100%);
        }

        .entry { font-size: 15px; margin-bottom: 8px; border-bottom: 1px solid rgba(0,0,0,0.08); color: #2b1a0f; font-weight: bold; }
        canvas { display: block; filter: saturate(1.1) contrast(1.05); }
    </style>
</head>
<body>

<div id="price-tag">â„¥ ...</div>
<div id="hash-rate-display">Sensing the Leyline...</div>

<div id="spellbook">
    <div style="font-family: 'Grenze Gotisch'; font-size: 28px; text-align: center; margin-bottom: 20px; color: #4a3728; border-bottom: 2px solid #4a3728;">The Ledger of Eternal Proof</div>
    <div id="log-content"></div>
</div>

<canvas id="screen"></canvas>

<script>
    const canvas = document.getElementById('screen');
    const ctx = canvas.getContext('2d');
    
    // 64-BIT PRECISION STATE
    let state = {
        btcPrice: 0.0,
        hashRate: 720_000_000_000_000_000_000n, // Exahash BigInt
        startDayPrice: 0.0,
        dpr: window.devicePixelRatio || 1,
        orbRotation: 0
    };

    let particles = [], rain = [], coins = 0;

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    // Initialize environment
    for(let i=0; i<100; i++) rain.push({x: Math.random()*window.innerWidth, y: Math.random()*window.innerHeight, v: 10+Math.random()*10});

    async function init() {
        const stats = await fetch('https://api.exchange.coinbase.com/products/BTC-USD/stats').then(r => r.json());
        state.startDayPrice = parseFloat(stats.open);

        const ws = new WebSocket('wss://ws-feed.exchange.coinbase.com');
        ws.onopen = () => ws.send(JSON.stringify({ type: "subscribe", channels: ["ticker", "matches"], product_ids: ["BTC-USD"] }));
        ws.onmessage = (e) => {
            const data = JSON.parse(e.data);
            if (data.type === 'ticker') {
                state.btcPrice = parseFloat(data.price);
                priceDisplay();
                coins = Math.max(0, (state.btcPrice - state.startDayPrice) / 10);
            }
            if (data.type === 'match') {
                logEntry(data);
                // Trigger Orb Pulse
                for(let i=0; i<5; i++) particles.push({
                    x: window.innerWidth/2, y: window.innerHeight*0.45,
                    vx: (Math.random()-0.5)*4, vy: (Math.random()-0.5)*4,
                    life: 1.0, size: Math.random()*4
                });
            }
        };
        // Simulated Hashrate jitter (64-bit)
        setInterval(() => {
            state.hashRate += BigInt(Math.floor((Math.random() - 0.5) * 1000000000000));
            document.getElementById('hash-rate-display').innerText = `Network Proof: ${(state.hashRate / 1_000_000_000_000_000_000n)} EH/s`;
        }, 3000);
    }

    function priceDisplay() {
        const el = document.getElementById('price-tag');
        el.innerText = `â„¥ ${state.btcPrice.toLocaleString()}`;
        el.style.color = state.btcPrice >= state.startDayPrice ? '#00d4ff' : '#ff4b2b';
    }

    function logEntry(data) {
        const div = document.createElement('div');
        div.className = 'entry';
        div.innerHTML = `ðŸ“œ ${parseFloat(data.size).toFixed(4)} BTC Transmuted @ ${parseFloat(data.price).toLocaleString()}`;
        document.getElementById('log-content').prepend(div);
        if (document.getElementById('log-content').childNodes.length > 12) document.getElementById('log-content').lastChild.remove();
    }

    function drawRoom() {
        const w = window.innerWidth, h = window.innerHeight;
        const cx = w/2, cy = h*0.45;

        // 1. Stone Walls & Floor
        const wallGrad = ctx.createRadialGradient(cx, cy, 100, cx, cy, w);
        wallGrad.addColorStop(0, '#3d342d');
        wallGrad.addColorStop(1, '#120e0a');
        ctx.fillStyle = wallGrad;
        ctx.fillRect(0, 0, w, h);

        // 2. The Desk
        ctx.fillStyle = '#2a1f18';
        ctx.fillRect(0, h * 0.75, w, h * 0.25);
        ctx.fillStyle = '#3d2b1f'; // Desk Edge
        ctx.fillRect(0, h * 0.75, w, 15);

        // 3. THE SCRYING ORB (The Focal Point)
        state.orbRotation += 0.01;
        const orbRadius = 140;

        // Orb Aura
        const aura = ctx.createRadialGradient(cx, cy, 0, cx, cy, orbRadius * 1.8);
        aura.addColorStop(0, 'rgba(0, 212, 255, 0.2)');
        aura.addColorStop(1, 'transparent');
        ctx.fillStyle = aura;
        ctx.beginPath(); ctx.arc(cx, cy, orbRadius * 1.8, 0, Math.PI*2); ctx.fill();

        // Inner Nebula (Based on Hashrate speed)
        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(state.orbRotation);
        for(let i=0; i<3; i++) {
            ctx.rotate(Math.PI / 1.5);
            ctx.fillStyle = 'rgba(0, 212, 255, 0.15)';
            ctx.beginPath();
            ctx.ellipse(0, 0, orbRadius * 0.8, orbRadius * 0.3, 0, 0, Math.PI*2);
            ctx.fill();
        }
        ctx.restore();

        // Glass Shell
        const shell = ctx.createRadialGradient(cx - 40, cy - 40, 10, cx, cy, orbRadius);
        shell.addColorStop(0, 'rgba(255, 255, 255, 0.4)');
        shell.addColorStop(0.2, 'rgba(255, 255, 255, 0.1)');
        shell.addColorStop(1, 'rgba(0, 0, 0, 0.6)');
        ctx.fillStyle = shell;
        ctx.beginPath(); ctx.arc(cx, cy, orbRadius, 0, Math.PI*2); ctx.fill();
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
        ctx.lineWidth = 2;
        ctx.stroke();

        // 4. Gold Coins
        ctx.fillStyle = '#d4af37';
        ctx.strokeStyle = '#4a3728';
        for(let i=0; i<coins; i++) {
            const stackX = w * 0.15;
            ctx.beginPath(); ctx.ellipse(stackX, h*0.75 - (i*6), 35, 12, 0, 0, Math.PI*2); ctx.fill(); ctx.stroke();
        }

        // 5. The Toad (Watching the Orb)
        ctx.fillStyle = '#4a5d3e';
        ctx.beginPath(); ctx.ellipse(w * 0.35, h * 0.77, 45, 25, 0, 0, Math.PI*2); ctx.fill();
        ctx.fillStyle = '#1a1a1a'; // Eyes
        ctx.beginPath(); ctx.arc(w * 0.33, h * 0.75, 6, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(w * 0.37, h * 0.75, 6, 0, Math.PI*2); ctx.fill();

        // 6. Magical Particles
        particles = particles.filter(p => {
            ctx.fillStyle = `rgba(0, 212, 255, ${p.life})`;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI*2); ctx.fill();
            p.x += p.vx; p.y += p.vy; p.life -= 0.01;
            return p.life > 0;
        });
    }

    function frame() {
        drawRoom();
        requestAnimationFrame(frame);
    }

    init(); frame();
</script>
</body>
</html>
